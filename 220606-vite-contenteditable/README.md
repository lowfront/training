# Simple Editor Example

HTML 붙여넣기 및 스타일링 기능 포함한 간단한 편집기 예제. 텍스트 입력시 DFS방식으로 노드 탐색 후 모든 노드를 플랫하게 처리하고 스타일 제거해서 표현. Google Keep의 링크 변환 개발 예정. 편집기능을 추가하는 것이 간단한 작업이 아닌것으로 보임

## 붙여넣기 HTML 파싱 규칙
텍스트 에디터에서 글쓰기와 붙여넣기 모두 이 방식으로 노드를 정리한다.
- 파싱은 DFS(깊이우선) 순서로 진행한다. (첫번째 자식을 타고 확인해야하는 조건이 많음)
- Root 노드는 block(줄넘김) 속성을 갖지 않는다.
- Root 노드의 block 방지 속성은 첫번째 자식 노드에게 재귀적으로 상속
- Block(줄넘김) 속성을 갖고 있는 노드는 첫번째 자식 노드에게 재귀적으로 상속
- Block 노드의 block 속성은 가장 끝에 있는 자식 노드로 BR 태그를 만나면 무효화(줄넘김 방지) 된다.
- BR 태그는 트리파싱의 다음 순서에 오는 형제노드에게 block 속성을 부여한다.
- Block 속성의 태그는 다음 순서에 오는 형제노드에게 block 속성을 부여한다.
- PRE 태그는 모든 속성 무시하고 개행문자(\n) 기준으로 텍스트와 노드 분할

## 줄넘김 규칙
- 현재 커서가 위치한 텍스트 노드와 텍스트 노드 위의 커서위치를 Selection 객체에서 확인
- 현재 커서 기준으로 텍스트 노드를 2개로 분리
- 분리한 텍스트 노드 사이에 BR 태그 삽입
- 텍스트 노드는 setStart 메소드에 그대로 넘겨서 포커싱하고, BR 태그는 포커싱이 잡히지 않으므로 부모태그를 넘기고 offset으로 포커싱
- 포커싱 노드가 부모노드와 같으면 텍스트 노드가 존재하지 않으므로 텍스트 노드 분리하는 대신 BR 태그만 입력
- 내용이 없는 초기상태에는 엔터 입력시 BR 두번 삽입해야 줄넘김 포커싱 가능
- BR 입력시 다음 노드 중 BR이 없으면(처음 BR 입력) 두 번 입력하고 뒤쪽 BR로 포커싱
- BR 입력시 다음 노드 중 BR이 있으면(이미 BR이 있음) 한 번 입력하고 뒤쪽 BR로 포커싱
- 내용 더 단순하게 정리
- 한글 조합중 줄넘기면 BR이 하나 더 삽입되는 버그 있음

## 링크 A 태그 변환 규칙 (작업중)
- 입력이 끝나면 디바운싱으로 정규 표현식을 이용해 링크 텍스트가 포함되어있는지 검사
- A 태그와 href 어트리뷰트가 있으면 해당 href 속성을 가진 것으로 취급
- A 태그인데 href 어트리뷰트가 없으면 단순 노드로 취급
- href 속성은 모든 자식노드에게 상속
- href 속성이 없을때 링크속성에 대한 붙여넣기 발생하면 
- 링크 태그 끝에서 타이핑하면 일반 타이핑, 안에서 타이핑하면 href은 그대로 두고 내부 텍스트만 수정

### Next Step
- [x] 붙여넣기 엔터 정확히 반영
- [x] pre, code 태그 파서
- [] 포커싱 함수 구현
- [] 링크감지 후 a 태그로 변환
- [] 커서 기준으로 중첩된 태그 나누기